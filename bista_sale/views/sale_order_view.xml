<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="sale_order_view_extended" model="ir.ui.view">
        <field name="name">sale.order.view.extend</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='partner_invoice_id']" position="attributes">
                <attribute name="string">Billing Address</attribute>
            </xpath>
            <xpath expr="//field[@name='order_line']/tree/field[@name='price_subtotal']" position="after">
                <field name="tracking_ref" optional="hide"/>
                <field name="attachment_ids" widget="many2many_binary" optional="show"/>
            </xpath>
            <xpath expr="//field[@name='order_line']/tree/field[@name='price_unit']" position="attributes">
                <attribute name="string">Cover Price</attribute>
                <attribute name="optional">show</attribute>
            </xpath>
            <xpath expr="//field[@name='order_line']/tree/field[@name='price_unit']" position="after">
                <field name="cost" optional="show"/>
                <field name="discounted_price" optional="show" readonly="1" />
                <field name="saving_amount" optional="show" readonly="1" />
            </xpath>
            <field name="tax_totals_json" position="after">
                <field style="font-size: 1.3em; font-weight: bold;" name="saving_amount" readonly="1" />
            </field>
            <xpath expr="//field[@name='validity_date']" position="attributes">
                <attribute name="string">Valid Until</attribute>
                <attribute name="attrs">{'invisible': 0 }</attribute>
            </xpath>
            <xpath expr="//group[@name='order_details']//div[hasclass('o_td_label')][1]" position="replace">
            
            <div class="o_td_label" >
                <label for="date_order" string="Quotation Date" attrs="{'invisible': [('state', 'in', ['sale', 'done', 'cancel', 'order_booked',  'pending_for_approval', 'credit_for_review'])]}"/>
                <label for="date_order" string="Order Date" attrs="{'invisible': [('state', 'in', ['draft', 'sent', 'quote_confirm', 'quote_approval'])]}"/>
            </div>
            <field name="date_order" nolabel="1" required="1"/>
                <!-- <div class="o_td_label" attrs="{'invisible': [('state', 'in', ['sale', 'done', 'cancel', 'order_booked',  'pending_for_approval', 'credit_for_review'])]}">
                    <label for="date_order" string="Quotation Date"/>
                </div> -->
            </xpath>
            <xpath expr="//group[@name='order_details']//field[@name='date_order'][1]" position="replace">
                <!-- <field name="date_order" nolabel="1"
                       attrs="{'invisible': [('state', 'in', ['sale', 'done', 'cancel', 'order_booked',  'pending_for_approval', 'credit_for_review'])]}"/> -->
            </xpath>
            <xpath expr="//group[@name='order_details']//div[hasclass('o_td_label')][2]" position="replace">
               <!--  <div class="o_td_label" attrs="{'invisible': [('state', 'not in', ['sale', 'done', 'cancel', 'order_booked',  'pending_for_approval', 'credit_for_review'])]}">
                    <label for="date_order" string="Order Date"/>
                </div> -->
            </xpath>
            <xpath expr="//group[@name='order_details']//field[@name='date_order'][2]" position="replace">
                <!-- <field name="date_order" nolabel="1"
                       attrs="{'invisible': [('state', 'in', ['draft', 'sent', 'quote_confirm', 'quote_approval'])]}"/> -->
            </xpath>
            <xpath expr="//field[@name='payment_term_id']" position="before">
                <field name="commitment_date"/>
            </xpath>
            <xpath expr="//field[@name='commitment_date']" position="attributes">
                <attribute name="string">Need By Date</attribute>
            </xpath>
            <xpath expr="//field[@name='payment_term_id']" position="after">
                <field name="client_order_ref"/>
            </xpath>
            <xpath expr="//field[@name='partner_id']" position="after">
                <field name="due_amount"/>
            </xpath>
            <xpath expr="//group/group[@name='sales_person']/field[@name='client_order_ref']" position="replace">
            </xpath>
            <xpath expr="//group[@name='sale_shipping']" position="replace">
                <span name="expected_date_span" class="text-muted">
                    Expected:
                    <field name="expected_date" widget="date"/>
                </span>
            </xpath>
            <xpath expr="//notebook/page[@name='other_information']" position="after">
                <page string="Order Details" name="order_details">
                    <group>
                        <group name="order_details">
                            <field name='refer_by_company'/>
                            <field name='refer_by_person'/>
                        </group>
                        <group>
                            <field name="account_order_standing" decoration-danger="account_order_standing == 'high'"
                                   decoration-warning="account_order_standing == 'medium'"
                                   decoration-success="account_order_standing == 'low'"/>
                            <!-- <field name="customer_email_add"/> -->
                        </group>
                    </group>
                </page>
            </xpath>
            <xpath expr="//notebook/page[@name='order_details']" position="after">
                <page string="Order Notes" name="order_notes">
                    <sheet>
                        <group>
                            <group name="order_notes">
                                <field name="event_date"/>
                                <field name="order_notes" class="bp_text_field"/>
                                <field name="gorgias_ticket" widget="url" class="bp_text_field"/>
                                <field name="product_status_notes" class="bp_text_field"/>
                            </group>
                            <group>
                                <field name="white_glove_id"/>
                                <field name="ce_notes" class="bp_text_field"/>
                                <field name="payment_notes" class="bp_text_field"/>
                                <field name="am_notes" class="bp_text_field"/>
                                <field name="ce_ops_acct_notes" class="bp_text_field"/>
                            </group>
                        </group>
                    </sheet>
                </page>
            </xpath>
            <xpath expr="//notebook/page[@name='order_notes']" position="after">
                <page name="journal_details" string="Journal Details">
                    <group>
                        <group name="journal_details">
                            <field name="journal_customization_ids"  widget="many2many_tags"
                                   options="{'color_field': 'color'}"/>
                            <field name="link_to_art_files" style="max-height: 25px;"/>
                            <field name="journal_notes" style="max-height: 25px;"/>
                            <field name="journal_setup_fee"  widget="monetary"/>
                            <field name="journal_setup_fee_waived"  widget="monetary"/>
                        </group>
                        <group>
                            <field name="shipping_account"/>
                            <field name="shipping_cost" widget="monetary"/>
                            <field name="artwork_status_id" />
                            <field name="death_type_id"/>
                            <field name="existing_death_order"/>
                            <field name="customization_cost" widget="monetary"/>
                        </group>
                     </group>
                </page>
            </xpath>
            <xpath expr="//notebook/page[@name='journal_details']" position="after">
                <page string="Fulfillment Project" name="project_fulfilment_trac">
                    <group>
                        <group name="project_fulfilment_tracking">
                            <field name="fulfilment_project"/>
                            <field name="am_owner"/>
                            <field name="project_description"/>
                            <field name="status_notes" class="bp_text_field"/>
                            <field name="delivery_location"/>
                            <field name="project_status"/>
                            <field name="shipping_instruction" class="bp_text_field"/>
                            <field name="customization_type_ids" widget="many2many_tags"/>
                            <field name="individual_mailer_return_address" class="bp_text_field_height"/>
                        </group>
                        <group>
                            <field name="special_insert_note" class="bp_text_field"/>
                            <field name="attachment_note" class="bp_text_field"/>
                            <field name="book_status"/>
                            <field name="on_hold_reason" class="bp_text_field"/>
                            <field name="recipient_list_status"/>
                            <field name="individual_mailer_return_receiver" class="bp_text_field_height"/>
                            <field name="recipient_list_expected" class="bp_text_field_char"/>
                        </group>
                    </group>
                </page>
            </xpath>
            <xpath expr="//notebook/page[@name='project_fulfilment_trac']" position="after">
                <page string="Payment">
                    <group>
                        <group name="payment_info">
                            <field name="billing_notes" class="bp_text_field"/>
                        </group>
                        <group>
                            <field name="placed_from_ip"/>
                        </group>
                    </group>
                </page>
            </xpath>
            <xpath expr="//notebook/page[last()]" position="after">
                <page name='best_seller_report' string='Best Seller Report'>
                    <group>
                        <field name="is_report" />
                        <field name="reason" attrs="{'invisible': [('is_report', '=', True)], 'required': [('is_report', '=', False)]}"/>
                        <field name="report_type" />
                        <field name="report_notes" />
                    </group>
                </page>
            </xpath>
        </field>
    </record>
</odoo>

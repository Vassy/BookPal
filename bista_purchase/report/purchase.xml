<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="address_layout_extended" inherit_id="web.address_layout">
        <xpath expr="//div[hasclass('address', 'row')]" position="replace">
            <div class="address row" style="margin-left: 5px;">
                <div name="address" class="col-4">
                    <t t-esc="address"/>
                </div>
                <t t-if="information_block">
                    <t t-set="colclass" t-value="'col-5 offset-1'"/>
                    <div name="information_block" class="col-4">
                        <t t-out="information_block"/>
                    </div>
                </t>
                <div name="custom_information_block" class="col-4"></div>
            </div>
        </xpath>
    </template>
    <template id="address_layout_extended_purchase" inherit_id="web.address_layout">
        <xpath expr="//div[@name='custom_information_block']" position="inside">
            <t t-if="not o" t-set="o" t-value="doc"/>
            <t t-if="doc_model == 'purchase.order'">
                <t t-if="o.state in ['draft','sent']">
                    <strong>RFQ #:</strong>
                    <t t-esc="o.name"/>
                    <br/>
                </t>
                <t t-if="o.state not in ['draft','sent']">
                    <strong>Purchase Order:</strong>
                    <t t-esc="o.name"/>
                    <br/>
                </t>
                <t t-if="o.state in ['draft','sent']">
                    <strong>RFQ Date:</strong>
                    <t t-esc="o.date_order" t-options='{"widget": "date"}'/>
                    <br/>
                </t>
                <t t-if="o.state not in ['draft','sent']">
                    <strong>Order Date:</strong>
                    <t t-esc="o.date_order" t-options='{"widget": "date"}'/>
                    <br/>
                </t>
                <strong>Salesperson:</strong>
                <t t-esc="o.user_id.name"/>
                <br/>
                <!-- <strong> Attention: </strong> <t t-esc="o.contact_id.name"/><br/>
                <strong> Ship Via: </strong><br/> -->
            </t>
        </xpath>
    </template>

    <template id="report_purchaseorder_document_extended" inherit_id="purchase.report_purchaseorder_document">
        <xpath expr="//h2[1]" position="replace">
        </xpath>
        <xpath expr="//h2[2]" position="replace">
        </xpath>
        <xpath expr="//h2[last()]" position="replace">
        </xpath>
        <xpath expr="//table[hasclass('table', 'table-sm', 'o_main_table')]" position="attributes">
            <attribute name="style">margin-top: 40px;</attribute>
        </xpath>
        <!-- Hidden information block from base report  -->
        <xpath expr="//div[@id='informations']" position="replace">
        </xpath>
        <!-- Added "Supplier Details" label in report  -->
        <xpath expr="//t[@t-set='address']/div" position="before">
            <strong>SUPPLIER</strong>
        </xpath>
        <!--        This Section Contains The Special Instractions And Notes.-->
        <!--        <xpath expr="//table[hasclass('table', 'table-sm', 'o_main_table')]" position="before">-->
        <!--            <t t-if="o.common_pick_note != '&lt;p&gt;&lt;br&gt;&lt;/p&gt;'">-->
        <!--                <div class='row mt-4'>-->
        <!--                    <div class="col-12">-->
        <!--                        <strong>Special Instructions and Notes</strong>-->
        <!--                        <p t-field="o.common_pick_note"/>-->
        <!--                    </div>-->
        <!--                </div>-->
        <!--            </t>-->
        <!--        </xpath>-->

        <xpath expr="//thead" position="replace">
            <!--            <span style="color: black; font-weight: bold;">Product Details</span>-->
            <thead>
                <tr>
                    <th name="th_sn" class="text-center">
                        <strong>ISBN</strong>
                    </th>
                    <!--                    <th name="th_default_code" class="text-center">-->
                    <!--                        <strong>Item</strong>-->
                    <!--                    </th>-->
                    <th name="th_description" class="text-cente">
                        <strong>Description</strong>
                    </th>
                    <!-- <th name="th_taxes" class="text-center"><strong>Taxes</strong></th> -->
                    <th name="th_quantity" class="text-center">
                        <strong>Qty</strong>
                    </th>
                    <th name="th_format" class="text-center">
                        <strong>Format</strong>
                    </th>
                    <!--                    <th name="th_uom" class="text-center">-->
                    <!--                        <strong>Uom</strong>-->
                    <!--                    </th>-->
                    <th name="th_cover" class="text-center">
                        <strong>Cover</strong>
                    </th>
                    <!--                    <th name="th_price_unit" class="text-center">-->
                    <!--                        <strong>Unit Price</strong>-->
                    <!--                    </th>-->
                    <th name="th_discount" class="text-center">
                        <strong>Discount</strong>
                    </th>
                    <th name="th_bp_price" class="text-center">
                        <strong>BP Price</strong>
                    </th>
                    <th name="th_amount" class="text-center">
                        <strong>Total</strong>
                    </th>
                </tr>
            </thead>
        </xpath>
        <xpath expr="//t[@t-foreach='o.order_line']" position="before">
            <t t-set="sn" t-value="1"/>
        </xpath>
        <xpath expr="//t[@t-if='not line.display_type']" position="replace">
            <t t-if="not line.display_type">
                <td name="td_sn" class="text-center">
                    <span t-esc="sn"/>
                    <br/>
                    <t t-set="sn" t-value="sn+1"/>
                </td>
                <!--                <td id="td_default_code" class="text-center">-->
                <!--                    <span t-field="line.product_id.default_code"/>-->
                <!--                </td>-->
                <td id="product">
                    <span t-field="line.name"/>
                </td>
                <!-- <td name="td_taxes" class="text-center">
                    <span t-esc="', '.join(map(lambda x: x.name, line.taxes_id))"/>
                </td> -->
                <td class="text-center">
                    <span t-if="float(line.product_qty).is_integer()"
                          t-esc="int(line.product_qty)"/>
                    <span t-if="not float(line.product_qty).is_integer()"
                          t-field="line.product_qty"/>
                </td>

                <td class="text-center" name="td_format">
                    <!--                    <t t-set="format" t-value="MMP"/>-->
                    <span t-esc="MMP"/>
                </td>
                <!--                <td class="text-center" name="td_uom">-->
                <!--                    <span t-field="line.product_uom.name" groups="uom.group_uom"/>-->
                <!--                </td>-->
                <td class="text-center" name="td_cover">
                    <span t-esc="6.99"/>
                </td>
                <td class="text-center" name="td_discount">
                    <span t-esc="65"/>
                </td>
                <td class="text-center" name="td_bp_price">
                    <span t-esc="245"/>
                </td>
                <!--                <td class="text-center">-->
                <!--                    <span t-field="line.price_unit"/>-->
                <!--                </td>-->
                <td class="text-center">
                    <span t-field="line.price_subtotal"
                          t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                </td>
            </t>
        </xpath>
        <!-- Add Comments before note field  -->
        <xpath expr="//p[@t-field='o.notes']" position="replace">
            <t t-if="o.notes != '&lt;p&gt;&lt;br&gt;&lt;/p&gt;'">
                <div class='row mt-4'>
                    <div class="col-12">
                        <strong>Purchase Order Terms and
                            Conditions
                        </strong>
                    </div>
                </div>
                <p t-field="o.notes"/>
            </t>
        </xpath>
    </template>
    <template id="report_purchaseorder_document_extended2" inherit_id="purchase_stock.report_purchaseorder_document">
        <xpath expr="//t[@t-else='']" position="replace">
            <t t-else="">
                <t t-set="information_block">
                    <strong>SHIP TO:</strong>
                    <div t-if="o.picking_type_id and o.picking_type_id.warehouse_id">
                        <span t-field="o.picking_type_id.warehouse_id.name"/>
                        <div t-field="o.picking_type_id.warehouse_id.partner_id"
                             t-options='{"widget": "contact", "fields": ["address", "phone"], "no_marker": True, "phone_icons": True}'/>
                    </div>
                </t>
            </t>
        </xpath>
    </template>
    <template id="document_tax_totals_extended" inherit_id="account.document_tax_totals">
        <xpath expr="//td[1]" position="replace">
            <td>Subtotal</td>
        </xpath>
        <xpath expr="//tr[hasclass('o_total')]" position="before">
            <td>Shipping</td>
            <td class="text-right">
                <span t-esc="20"/>
            </td>
        </xpath>
    </template>
</odoo>
